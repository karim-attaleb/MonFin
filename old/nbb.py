import os
import filemanager as fm
import helper
import pandas as pd
import table as tb
import io
import re



def determine_import_table(file_without_ext, searchstring_annual, seachstring_ratio, searchstring_rubric):
    try:
        match_annual = re.search(searchstring_annual, file_without_ext)
        match_ratio = re.search(seachstring_ratio, file_without_ext)
        match_rubric = re.search(searchstring_rubric, file_without_ext)
        print(file_without_ext)
        # if fm.left(file_without_ext, 6) == "annual":
        if match_annual:
            table = "Tbl_RawData_NBB_AnnualAccountReport"
            return table
        # elif fm.left(file_without_ext, 11) == "ratioReport":
        elif match_ratio:
            table = "Tbl_RawData_NBB_ratioReport"
            return table
        # elif fm.left(file_without_ext, 12) == "rubricReport":
        elif match_rubric:
            table = "Tbl_RawData_NBB_rubricReport"
            return table
        # elif fm.left(file_without_ext, 11) == "inputReport":
        #     table = "Tbl_RawData_NBB_inputReport"
        #     return table
        else:
            pass
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb getting tablename based on filename): %s, args=%s: ", e, e.args)

#region Annual
def create_table_nbb_annual(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_AnnualAccountReport (
                        CompanyNumber text,
                        CompanyNameFR text,
                        StreetFR text,
                        HouseNumberFR text,
                        BusNumberFR text,
                        PostalCodeDE int64,
                        CityFR text,
                        CountryCodeFR text,
                        CompanyNameDE text,
                        StreetDE text,
                        HouseNumberDE text,
                        BusNumberDE text,
                        [PostalCodeDE1] text,
                        CityDE text,
                        CountryCodeDE text,
                        CompanyNameNL text,
                        StreetNL text,
                        HouseNumberNL text,
                        BusNumberNL text,
                        PostalCodeNL text,
                        CityNL text,
                        CountryCodeNL int64,
                        CompanyNameEN text,
                        CompanyNameOther text,
                        JuridicalFormCode int64,
                        JuridicalSituationCode text,
                        JuridicalSituationDate datetime64[ns],
                        NaceCode text,
                        NisCode text,
                        AccountingYear int64,
                        StartDateAccounting datetime64[ns],
                        EndDateAccounting datetime64[ns],
                        NbMonthAccountingYear int64,
                        DateGeneralAssembly datetime64[ns],
                        DateDeposit datetime64[ns],
                        ExternalFlag object,
                        FileBase object);""")

    # c.execute(
    #     """
    #     CREATE INDEX alias_pin_IDX ON alias(pin);
    #     """)

        cur.execute("""DELETE FROM Tbl_RawData_NBB_AnnualAccountReport;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_AnnualAccountReport has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_annual): %s, args=%s: ",e, e.args)


def df_nbb_annual_to_db(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_AnnualAccountReport', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_AnnualAccountReport")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_AnnualAccountReport has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb anual): %s, args=%s: ", e, e.args)
#endregion Annual

#region Ratio
def create_table_nbb_ratio(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_RatioReport (
                    CompanyNumber text,
                    AccountingYear int64,
                    Schema object,
                    RAT001 float64,
                    RAT002 float64,
                    RAT003 float64,
                    RAT004 float64,
                    RAT005 float64,
                    RAT006 float64,
                    RAT007 float64,
                    RAT008 float64,
                    RAT009 float64,
                    RAT010 float64,
                    RAT011 float64,
                    RAT012 float64,
                    RAT013 float64,
                    RAT014 float64,
                    RAT015 float64,
                    RAT016 float64,
                    RAT017 float64,
                    RAT018 float64,
                    RAT019 float64,
                    RAT020 float64,
                    RAT021 float64,
                    RAT101 float64,
                    RAT102 float64,
                    RAT103 float64,
                    RAT104 float64,
                    RAT105 float64,
                    RAT106 float64,
                    RAT107 float64,
                    RAT108 float64,
                    RAT109 float64,
                    RAT110 float64,
                    RAT111 float64,
                    RAT112 float64,
                    RAT113 float64,
                    RAT114 float64,
                    RAT115 float64,
                    RAT116 float64,
                    RAT117 float64,
                    RAT118 float64,
                    RAT119 float64,
                    RAT120 float64,
                    RAT121 float64,
                    RAT125 float64,
                    RAT127 float64,
                    RAT201 float64,
                    RAT202 float64,
                    RAT203 float64,
                    RAT204 float64,
                    RAT205 float64,
                    RAT206 float64,
                    RAT207 float64,
                    RAT208 float64,
                    RAT209 float64,
                    RAT210 float64,
                    RAT211 float64,
                    RAT212 float64,
                    RAT213 float64,
                    RAT214 float64,
                    RAT217 float64,
                    RAT218 float64,
                    RAT219 float64,
                    RAT220 float64,
                    RAT221 float64,
                    FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_RatioReport""") # truncate
        helper.logger.info("Table Tbl_RawData_NBB_RatioReport has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_ratio): %s, args=%s: ",e, e.args)


def df_nbb_ratio_to_db(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_RatioReport', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_RatioReport")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_RatioReport has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb ratio): %s, args=%s: ", e, e.args)
#endregion Ratio

#region Rubric
#ARS1
def create_table_nbb_rubric1(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport1 (
                        CompanyNumber text,
                        AccountingYear int64,
                        Schema object,
                        [RUB 10] float64,
                        [RUB 10/11] float64,
                        [RUB 10/15] float64,
                        [RUB 10/49] float64,
                        [RUB 100] float64,
                        [RUB 1001] float64,
                        [RUB 10011] float64,
                        [RUB 10012] float64,
                        [RUB 1002] float64,
                        [RUB 10021] float64,
                        [RUB 10022] float64,
                        [RUB 1003] float64,
                        [RUB 10031] float64,
                        [RUB 10031P] float64,
                        [RUB 10032] float64,
                        [RUB 10032P] float64,
                        [RUB 1003P] float64,
                        [RUB 100P] float64,
                        [RUB 101] float64,
                        [RUB 1011] float64,
                        [RUB 10111] float64,
                        [RUB 10112] float64,
                        [RUB 1012] float64,
                        [RUB 10121] float64,
                        [RUB 10122] float64,
                        [RUB 1013] float64,
                        [RUB 10131] float64,
                        [RUB 10131P] float64,
                        [RUB 10132] float64,
                        [RUB 10132P] float64,
                        [RUB 1013P] float64,
                        [RUB 1021] float64,
                        [RUB 10211] float64,
                        [RUB 10212] float64,
                        [RUB 1022] float64,
                        [RUB 10221] float64,
                        [RUB 10222] float64,
                        [RUB 1023] float64,
                        [RUB 10231] float64,
                        [RUB 10231P] float64,
                        [RUB 10232] float64,
                        [RUB 10232P] float64,
                        [RUB 1023P] float64,
                        [RUB 1033] float64,
                        [RUB 10331] float64,
                        [RUB 10331P] float64,
                        [RUB 10332] float64,
                        [RUB 10332P] float64,
                        [RUB 1033P] float64,
                        [RUB 1051] float64,
                        [RUB 1052] float64,
                        [RUB 1053] float64,
                        [RUB 11] float64,
                        [RUB 110] float64,
                        [RUB 1100/10] float64,
                        [RUB 1101] float64,
                        [RUB 1102] float64,
                        [RUB 1103] float64,
                        [RUB 1109/19] float64,
                        [RUB 110P] float64,
                        [RUB 111] float64,
                        [RUB 1111] float64,
                        [RUB 1112] float64,
                        [RUB 1113] float64,
                        [RUB 111P] float64,
                        [RUB 1121] float64,
                        [RUB 1122] float64,
                        [RUB 1123] float64,
                        [RUB 1131] float64,
                        [RUB 1132] float64,
                        [RUB 1133] float64,
                        [RUB 12] float64,
                        [RUB 12001] float64,
                        [RUB 12002] float64,
                        [RUB 12003] float64,
                        [RUB 1201] float64,
                        [RUB 12011] float64,
                        [RUB 12012] float64,
                        [RUB 12013] float64,
                        [RUB 1202] float64,
                        [RUB 12021] float64,
                        [RUB 12022] float64,
                        [RUB 12023] float64,
                        [RUB 1203] float64,
                        [RUB 12031] float64,
                        [RUB 12032] float64,
                        [RUB 12033] float64,
                        [RUB 12101] float64,
                        [RUB 12102] float64,
                        [RUB 12103] float64,
                        [RUB 1211] float64,
                        [RUB 12111] float64,
                        [RUB 12112] float64,
                        [RUB 12113] float64,
                        [RUB 1212] float64,
                        [RUB 12121] float64,
                        [RUB 12122] float64,
                        [RUB 12123] float64,
                        [RUB 1213] float64,
                        [RUB 12131] float64,
                        [RUB 12132] float64,
                        [RUB 12133] float64,
                        [RUB 13] float64,
                        [RUB 130] float64,
                        [RUB 130/1] float64,
                        [RUB 1301] float64,
                        [RUB 1302] float64,
                        [RUB 1303] float64,
                        [RUB 131] float64,
                        [RUB 1310] float64,
                        [RUB 1311] float64,
                        [RUB 1312] float64,
                        [RUB 1313] float64,
                        [RUB 1319] float64,
                        [RUB 132] float64,
                        [RUB 1321] float64,
                        [RUB 1322] float64,
                        [RUB 1323] float64,
                        [RUB 133] float64,
                        [RUB 1331] float64,
                        [RUB 1332] float64,
                        [RUB 1333] float64,
                        [RUB 1341] float64,
                        [RUB 1342] float64,
                        [RUB 1343] float64,
                        [RUB 14] float64,
                        [RUB 14P] float64,
                        [RUB 15] float64,
                        [RUB 1501] float64,
                        [RUB 1502] float64,
                        [RUB 1511] float64,
                        [RUB 1512] float64,
                        [RUB 1521] float64,
                        [RUB 1522] float64,
                        [RUB 16] float64,
                        [RUB 160] float64,
                        [RUB 160/5] float64,
                        [RUB 161] float64,
                        [RUB 162] float64,
                        [RUB 163] float64,
                        [RUB 164/5] float64,
                        [RUB 168] float64,
                        [RUB 17] float64,
                        [RUB 17/49] float64,
                        [RUB 170] float64,
                        [RUB 170/4] float64,
                        [RUB 171] float64,
                        [RUB 172] float64,
                        [RUB 172/3] float64,
                        [RUB 173] float64,
                        [RUB 174] float64,
                        [RUB 174/0] float64,
                        [RUB 175] float64,
                        [RUB 1750] float64,
                        [RUB 176] float64,
                        [RUB 178/9] float64,
                        [RUB 19] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport1;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport1 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric1): %s, args=%s: ", e, e.args)

def limit_rubric1(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 10",
        "RUB 10/11",
        "RUB 10/15",
        "RUB 10/49",
        "RUB 100",
        "RUB 1001",
        "RUB 10011",
        "RUB 10012",
        "RUB 1002",
        "RUB 10021",
        "RUB 10022",
        "RUB 1003",
        "RUB 10031",
        "RUB 10031P",
        "RUB 10032",
        "RUB 10032P",
        "RUB 1003P",
        "RUB 100P",
        "RUB 101", #*
        "RUB 1011",
        "RUB 10111",
        "RUB 10112",
        "RUB 1012",
        "RUB 10121",
        "RUB 10122",
        "RUB 1013",
        "RUB 10131",
        "RUB 10131P",
        "RUB 10132",
        "RUB 10132P",
        "RUB 1013P",
        "RUB 1021",
        "RUB 10211",
        "RUB 10212",
        "RUB 1022",
        "RUB 10221",
        "RUB 10222",
        "RUB 1023",
        "RUB 10231",
        "RUB 10231P",
        "RUB 10232",
        "RUB 10232P",
        "RUB 1023P",
        "RUB 1033",
        "RUB 10331",
        "RUB 10331P",
        "RUB 10332",
        "RUB 10332P",
        "RUB 1033P",
        "RUB 1051",
        "RUB 1052",
        "RUB 1053",
        "RUB 11",
        "RUB 110",
        "RUB 1100/10",
        "RUB 1101",
        "RUB 1102",
        "RUB 1103",
        "RUB 1109/19",
        "RUB 110P",
        "RUB 111",
        "RUB 1111",
        "RUB 1112",
        "RUB 1113",
        "RUB 111P",
        "RUB 1121", #*
        "RUB 1122", #*
        "RUB 1123", #*
        "RUB 1131",
        "RUB 1132", #*
        "RUB 1133",
        "RUB 12",
        "RUB 12001",
        "RUB 12002",
        "RUB 12003",
        "RUB 1201",
        "RUB 12011",
        "RUB 12012",
        "RUB 12013",
        "RUB 1202",
        "RUB 12021",
        "RUB 12022",
        "RUB 12023",
        "RUB 1203",
        "RUB 12031",
        "RUB 12032",
        "RUB 12033",
        "RUB 12101",
        "RUB 12102",
        "RUB 12103",
        "RUB 1211",
        "RUB 12111",
        "RUB 12112",
        "RUB 12113",
        "RUB 1212",
        "RUB 12121",
        "RUB 12122",
        "RUB 12123",
        "RUB 1213",
        "RUB 12131",
        "RUB 12132",
        "RUB 12133",
        "RUB 13",
        "RUB 130",
        "RUB 130/1",
        "RUB 1301",
        "RUB 1302",
        "RUB 1303",
        "RUB 131", #*
        "RUB 1310", #*
        "RUB 1311",
        "RUB 1312", #*
        "RUB 1313", #*
        "RUB 1319",
        "RUB 132",
        "RUB 1321",
        "RUB 1322",
        "RUB 1323",
        "RUB 133",
        "RUB 1331",
        "RUB 1332",
        "RUB 1333",
        "RUB 1341",
        "RUB 1342",
        "RUB 1343",
        "RUB 14",
        "RUB 14P",
        "RUB 15",
        "RUB 1501",
        "RUB 1502", #*
        "RUB 1511",
        "RUB 1512", #*
        "RUB 1521",
        "RUB 1522", #*
        "RUB 16",
        "RUB 160",
        "RUB 160/5",
        "RUB 161",
        "RUB 162",
        "RUB 163",
        "RUB 164/5",
        "RUB 168",
        "RUB 17",
        "RUB 17/49",
        "RUB 170",
        "RUB 170/4",
        "RUB 171", #*
        "RUB 172",
        "RUB 172/3",
        "RUB 173",
        "RUB 174",
        "RUB 174/0",
        "RUB 175",
        "RUB 1750", #*
        "RUB 176", #*
        "RUB 178/9",
        "RUB 19", #*
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db1(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport1', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport1")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport1 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric1): %s, args=%s: ", e, e.args)

#ARS2
def create_table_nbb_rubric2(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport2 (
                        CompanyNumber text,
                        AccountingYear int64,
                        Schema object,
                        [RUB 20] float64,
                        [RUB 20/58] float64,
                        [RUB 200/2] float64,
                        [RUB 204] float64,
                        [RUB 2051] float64,
                        [RUB 2052] float64,
                        [RUB 2053] float64,
                        [RUB 20P] float64,
                        [RUB 21] float64,
                        [RUB 21/28] float64,
                        [RUB 210] float64,
                        [RUB 2101] float64,
                        [RUB 2102] float64,
                        [RUB 2103] float64,
                        [RUB 211] float64,
                        [RUB 2111] float64,
                        [RUB 2112] float64,
                        [RUB 2113] float64,
                        [RUB 212] float64,
                        [RUB 2121] float64,
                        [RUB 2122] float64,
                        [RUB 2123] float64,
                        [RUB 213] float64,
                        [RUB 2131] float64,
                        [RUB 2132] float64,
                        [RUB 2133] float64,
                        [RUB 22] float64,
                        [RUB 22/27] float64,
                        [RUB 23] float64,
                        [RUB 24] float64,
                        [RUB 25] float64,
                        [RUB 250] float64,
                        [RUB 251] float64,
                        [RUB 252] float64,
                        [RUB 26] float64,
                        [RUB 27] float64,
                        [RUB 28] float64,
                        [RUB 280] float64,
                        [RUB 280/1] float64,
                        [RUB 281] float64,
                        [RUB 281P] float64,
                        [RUB 282] float64,
                        [RUB 282/3] float64,
                        [RUB 283] float64,
                        [RUB 283P] float64,
                        [RUB 284] float64,
                        [RUB 284/8] float64,
                        [RUB 285/8] float64,
                        [RUB 285/8P] float64,
                        [RUB 29] float64,
                        [RUB 29/58] float64,
                        [RUB 290] float64,
                        [RUB 291] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport2;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport2 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric2): %s, args=%s: ", e, e.args)

def limit_rubric2(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 20",
        "RUB 20/58",
        "RUB 200/2",
        "RUB 204",
        "RUB 2051",
        "RUB 2052",
        "RUB 2053",
        "RUB 20P",
        "RUB 21",
        "RUB 21/28",
        "RUB 210",
        "RUB 2101",
        "RUB 2102",
        "RUB 2103",
        "RUB 211",
        "RUB 2111",
        "RUB 2112",
        "RUB 2113",
        "RUB 212",
        "RUB 2121",
        "RUB 2122",
        "RUB 2123",
        "RUB 213",
        "RUB 2131",
        "RUB 2132",
        "RUB 2133",
        "RUB 22",
        "RUB 22/27",
        "RUB 23",
        "RUB 24",
        "RUB 25",
        "RUB 250",
        "RUB 251",
        "RUB 252",
        "RUB 26",
        "RUB 27",
        "RUB 28",
        "RUB 280",
        "RUB 280/1",
        "RUB 281",
        "RUB 281P",
        "RUB 282",
        "RUB 282/3",
        "RUB 283",
        "RUB 283P",
        "RUB 284",
        "RUB 284/8",
        "RUB 285/8",
        "RUB 285/8P",
        "RUB 29",
        "RUB 29/58",
        "RUB 290",
        "RUB 291",
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db2(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport2', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport2")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport2 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric2): %s, args=%s: ", e, e.args)

#ARS3
def create_table_nbb_rubric3(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport3 (
                        CompanyNumber text,
                        AccountingYear int64,
                        Schema object,
                        [RUB 3] float64,
                        [RUB 30/31] float64,
                        [RUB 30/36] float64,
                        [RUB 3051] float64,
                        [RUB 3052] float64,
                        [RUB 3053] float64,
                        [RUB 3101] float64,
                        [RUB 3102] float64,
                        [RUB 3103] float64,
                        [RUB 3111] float64,
                        [RUB 3112] float64,
                        [RUB 3113] float64,
                        [RUB 3121] float64,
                        [RUB 3122] float64,
                        [RUB 3123] float64,
                        [RUB 3131] float64,
                        [RUB 3132] float64,
                        [RUB 3133] float64,
                        [RUB 32] float64,
                        [RUB 33] float64,
                        [RUB 34] float64,
                        [RUB 3401] float64,
                        [RUB 3402] float64,
                        [RUB 3403] float64,
                        [RUB 3411] float64,
                        [RUB 3412] float64,
                        [RUB 3413] float64,
                        [RUB 3421] float64,
                        [RUB 3422] float64,
                        [RUB 3423] float64,
                        [RUB 3431] float64,
                        [RUB 3432] float64,
                        [RUB 3433] float64,
                        [RUB 35] float64,
                        [RUB 36] float64,
                        [RUB 37] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport3;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport3 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric3): %s, args=%s: ", e, e.args)

def limit_rubric3(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 3",
        "RUB 30/31",
        "RUB 30/36",
        "RUB 3051",
        "RUB 3052",
        "RUB 3053",
        "RUB 3101",
        "RUB 3102",
        "RUB 3103",
        "RUB 3111",
        "RUB 3112",
        "RUB 3113",
        "RUB 3121",
        "RUB 3122",
        "RUB 3123",
        "RUB 3131",
        "RUB 3132",
        "RUB 3133",
        "RUB 32",
        "RUB 33",
        "RUB 34",
        "RUB 3401",
        "RUB 3402",
        "RUB 3403",
        "RUB 3411",
        "RUB 3412",
        "RUB 3413",
        "RUB 3421",
        "RUB 3422",
        "RUB 3423",
        "RUB 3431",
        "RUB 3432",
        "RUB 3433",
        "RUB 35",
        "RUB 36",
        "RUB 37",
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db3(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport3', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport3")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport3 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric3): %s, args=%s: ", e, e.args)

#ARS4
def create_table_nbb_rubric4(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport4 (
                        CompanyNumber text,
                        AccountingYear int64,
                        Schema object,
                        [RUB 40] float64,
                        [RUB 40/41] float64,
                        [RUB 41] float64,
                        [RUB 42] float64,
                        [RUB 42/48] float64,
                        [RUB 43] float64,
                        [RUB 430/8] float64,
                        [RUB 439] float64,
                        [RUB 44] float64,
                        [RUB 440/4] float64,
                        [RUB 441] float64,
                        [RUB 45] float64,
                        [RUB 450] float64,
                        [RUB 450/3] float64,
                        [RUB 454/9] float64,
                        [RUB 46] float64,
                        [RUB 47/48] float64,
                        [RUB 490/1] float64,
                        [RUB 492/3] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport4;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport4 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric4): %s, args=%s: ", e, e.args)

def limit_rubric4(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 40",
        "RUB 40/41",
        "RUB 41",
        "RUB 42",
        "RUB 42/48",
        "RUB 43",
        "RUB 430/8",
        "RUB 439",
        "RUB 44",
        "RUB 440/4",
        "RUB 441",
        "RUB 45",
        "RUB 450",
        "RUB 450/3",
        "RUB 454/9",
        "RUB 46",
        "RUB 47/48",
        "RUB 490/1",
        "RUB 492/3",
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db4(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport4', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport4")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport4 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric4): %s, args=%s: ", e, e.args)

#ARS5
def create_table_nbb_rubric5(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport5 (
                        CompanyNumber text,
                        AccountingYear int64,
                        Schema object,
                        [RUB 50] float64,
                        [RUB 50/53] float64,
                        [RUB 51] float64,
                        [RUB 51/53] float64,
                        [RUB 52] float64,
                        [RUB 53] float64,
                        [RUB 54/58] float64,
                        [RUB 5801] float64,
                        [RUB 5802] float64,
                        [RUB 5803] float64,
                        [RUB 58031] float64,
                        [RUB 58032] float64,
                        [RUB 58033] float64,
                        [RUB 5811] float64,
                        [RUB 5812] float64,
                        [RUB 5813] float64,
                        [RUB 58131] float64,
                        [RUB 58132] float64,
                        [RUB 58133] float64,
                        [RUB 5821] float64,
                        [RUB 5822] float64,
                        [RUB 5823] float64,
                        [RUB 5831] float64,
                        [RUB 5832] float64,
                        [RUB 5833] float64,
                        [RUB 5841] float64,
                        [RUB 5842] float64,
                        [RUB 5843] float64,
                        [RUB 5851] float64,
                        [RUB 5852] float64,
                        [RUB 5853] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport5;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport5 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric5): %s, args=%s: ", e, e.args)

def limit_rubric5(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 50",
        "RUB 50/53",
        "RUB 51",
        "RUB 51/53",
        "RUB 52",
        "RUB 53",
        "RUB 54/58",
        "RUB 5801",
        "RUB 5802",
        "RUB 5803",
        "RUB 58031",
        "RUB 58032",
        "RUB 58033",
        "RUB 5811",
        "RUB 5812",
        "RUB 5813",
        "RUB 58131",
        "RUB 58132",
        "RUB 58133",
        "RUB 5821",
        "RUB 5822",
        "RUB 5823",
        "RUB 5831",
        "RUB 5832",
        "RUB 5833",
        "RUB 5841",
        "RUB 5842",
        "RUB 5843",
        "RUB 5851",
        "RUB 5852",
        "RUB 5853",
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db5(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport5', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport5")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport5 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric5): %s, args=%s: ", e, e.args)

#ARS6
def create_table_nbb_rubric6(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport6 (
                        CompanyNumber text,
                        AccountingYear int64,
                        Schema object,
                        [RUB 60] float64,
                        [RUB 60/61] float64,
                        [RUB 60/66A] float64,
                        [RUB 600/8] float64,
                        [RUB 609] float64,
                        [RUB 61] float64,
                        [RUB 617] float64,
                        [RUB 62] float64,
                        [RUB 620] float64,
                        [RUB 621] float64,
                        [RUB 622] float64,
                        [RUB 623] float64,
                        [RUB 624] float64,
                        [RUB 630] float64,
                        [RUB 631/4] float64,
                        [RUB 635] float64,
                        [RUB 635/8] float64,
                        [RUB 640] float64,
                        [RUB 640/8] float64,
                        [RUB 641/8] float64,
                        [RUB 649] float64,
                        [RUB 65] float64,
                        [RUB 65/66B] float64,
                        [RUB 650] float64,
                        [RUB 6501] float64,
                        [RUB 6502] float64,
                        [RUB 6503] float64,
                        [RUB 651] float64,
                        [RUB 6510] float64,
                        [RUB 6511] float64,
                        [RUB 652/9] float64,
                        [RUB 653] float64,
                        [RUB 654] float64,
                        [RUB 655] float64,
                        [RUB 6560] float64,
                        [RUB 6561] float64,
                        [RUB 66] float64,
                        [RUB 660] float64,
                        [RUB 661] float64,
                        [RUB 662] float64,
                        [RUB 6620] float64,
                        [RUB 6621] float64,
                        [RUB 662AB] float64,
                        [RUB 663] float64,
                        [RUB 6630] float64,
                        [RUB 6631] float64,
                        [RUB 663AB] float64,
                        [RUB 664/7] float64,
                        [RUB 664/8] float64,
                        [RUB 664/8AB] float64,
                        [RUB 668] float64,
                        [RUB 669] float64,
                        [RUB 6690] float64,
                        [RUB 669AB] float64,
                        [RUB 66A] float64,
                        [RUB 66AB] float64,
                        [RUB 66B] float64,
                        [RUB 67/77] float64,
                        [RUB 670/3] float64,
                        [RUB 680] float64,
                        [RUB 689] float64,
                        [RUB 691] float64,
                        [RUB 691/2] float64,
                        [RUB 6920] float64,
                        [RUB 6921] float64,
                        [RUB 694] float64,
                        [RUB 694/7] float64,
                        [RUB 695] float64,
                        [RUB 696] float64,
                        [RUB 697] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport6;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport6 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric6): %s, args=%s: ", e, e.args)

def limit_rubric6(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 60",
        "RUB 60/61",
        "RUB 60/66A",
        "RUB 600/8",
        "RUB 609",
        "RUB 61",
        "RUB 617",
        "RUB 62",
        "RUB 620",
        "RUB 621",
        "RUB 622",
        "RUB 623",
        "RUB 624",
        "RUB 630",
        "RUB 631/4",
        "RUB 635",
        "RUB 635/8",
        "RUB 640",
        "RUB 640/8",
        "RUB 641/8",
        "RUB 649",
        "RUB 65",
        "RUB 65/66B",
        "RUB 650",
        "RUB 6501",
        "RUB 6502",
        "RUB 6503",
        "RUB 651",
        "RUB 6510",
        "RUB 6511",
        "RUB 652/9",
        "RUB 653",
        "RUB 654",
        "RUB 655",
        "RUB 6560",
        "RUB 6561",
        "RUB 66",
        "RUB 660",
        "RUB 661",
        "RUB 662",
        "RUB 6620",
        "RUB 6621",
        "RUB 662AB",
        "RUB 663",
        "RUB 6630",
        "RUB 6631",
        "RUB 663AB",
        "RUB 664/7",
        "RUB 664/8",
        "RUB 664/8AB",
        "RUB 668",
        "RUB 669",
        "RUB 6690",
        "RUB 669AB",
        "RUB 66A",
        "RUB 66AB",
        "RUB 66B",
        "RUB 67/77",
        "RUB 670/3",
        "RUB 680",
        "RUB 689",
        "RUB 691",
        "RUB 691/2",
        "RUB 6920",
        "RUB 6921",
        "RUB 694",
        "RUB 694/7",
        "RUB 695",
        "RUB 696",
        "RUB 697",
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db6(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport6', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport6")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport6 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric6): %s, args=%s: ", e, e.args)

#ARS7
def create_table_nbb_rubric7(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport7 (
                        CompanyNumber text,
                        AccountingYear int74,
                        Schema object,
                        [RUB 70] float64,
                        [RUB 70/76A] float64,
                        [RUB 71] float64,
                        [RUB 72] float64,
                        [RUB 74] float64,
                        [RUB 740] float64,
                        [RUB 75] float64,
                        [RUB 75/76B] float64,
                        [RUB 750] float64,
                        [RUB 751] float64,
                        [RUB 752/9] float64,
                        [RUB 753] float64,
                        [RUB 754] float64,
                        [RUB 755] float64,
                        [RUB 76] float64,
                        [RUB 760] float64,
                        [RUB 761] float64,
                        [RUB 762] float64,
                        [RUB 7620] float64,
                        [RUB 762AB] float64,
                        [RUB 763] float64,
                        [RUB 7630] float64,
                        [RUB 7631] float64,
                        [RUB 763AB] float64,
                        [RUB 764/8] float64,
                        [RUB 764/9] float64,
                        [RUB 764/9AB] float64,
                        [RUB 769] float64,
                        [RUB 76A] float64,
                        [RUB 76AB] float64,
                        [RUB 76B] float64,
                        [RUB 77] float64,
                        [RUB 780] float64,
                        [RUB 789] float64,
                        [RUB 791] float64,
                        [RUB 791/2] float64,
                        [RUB 792] float64,
                        [RUB 794] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport7;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport7 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric7): %s, args=%s: ", e, e.args)

def limit_rubric7(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 70",
        "RUB 70/76A",
        "RUB 71",
        "RUB 72",
        "RUB 74",
        "RUB 740",
        "RUB 75",
        "RUB 75/76B",
        "RUB 750",
        "RUB 751",
        "RUB 752/9",
        "RUB 753",
        "RUB 754",
        "RUB 755",
        "RUB 76",
        "RUB 760",
        "RUB 761",
        "RUB 762",
        "RUB 7620",
        "RUB 762AB",
        "RUB 763",
        "RUB 7630",
        "RUB 7631",
        "RUB 763AB",
        "RUB 764/8",
        "RUB 764/9",
        "RUB 764/9AB",
        "RUB 769",
        "RUB 76A",
        "RUB 76AB",
        "RUB 76B",
        "RUB 77",
        "RUB 780",
        "RUB 789",
        "RUB 791",
        "RUB 791/2",
        "RUB 792",
        "RUB 794",
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db7(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport7', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport7")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport7 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric7): %s, args=%s: ", e, e.args)

#ARS8
def create_table_nbb_rubric8(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport8 (
                        CompanyNumber text,
                        AccountingYear int84,
                        Schema object,
                        [RUB 8002] float64,
                        [RUB 8003] float64,
                        [RUB 8021] float64,
                        [RUB 8022] float64,
                        [RUB 8023] float64,
                        [RUB 8024] float64,
                        [RUB 8025] float64,
                        [RUB 8029] float64,
                        [RUB 8031] float64,
                        [RUB 8032] float64,
                        [RUB 8033] float64,
                        [RUB 8039] float64,
                        [RUB 8041] float64,
                        [RUB 8042] float64,
                        [RUB 8043] float64,
                        [RUB 8049] float64,
                        [RUB 8051] float64,
                        [RUB 8051P] float64,
                        [RUB 8052] float64,
                        [RUB 8052P] float64,
                        [RUB 8053] float64,
                        [RUB 8053P] float64,
                        [RUB 8054] float64,
                        [RUB 8054P] float64,
                        [RUB 8055] float64,
                        [RUB 8055P] float64,
                        [RUB 8056] float64,
                        [RUB 8059] float64,
                        [RUB 8059P] float64,
                        [RUB 8071] float64,
                        [RUB 8072] float64,
                        [RUB 8073] float64,
                        [RUB 8074] float64,
                        [RUB 8075] float64,
                        [RUB 8079] float64,
                        [RUB 8082] float64,
                        [RUB 8089] float64,
                        [RUB 8092] float64,
                        [RUB 8099] float64,
                        [RUB 8101] float64,
                        [RUB 8102] float64,
                        [RUB 8103] float64,
                        [RUB 8109] float64,
                        [RUB 8111] float64,
                        [RUB 8112] float64,
                        [RUB 8113] float64,
                        [RUB 8119] float64,
                        [RUB 8121] float64,
                        [RUB 8121P] float64,
                        [RUB 8122] float64,
                        [RUB 8122P] float64,
                        [RUB 8123] float64,
                        [RUB 8123P] float64,
                        [RUB 8124] float64,
                        [RUB 8124P] float64,
                        [RUB 8125] float64,
                        [RUB 8125P] float64,
                        [RUB 8126] float64,
                        [RUB 8129] float64,
                        [RUB 8129P] float64,
                        [RUB 81311] float64,
                        [RUB 81312] float64,
                        [RUB 81313] float64,
                        [RUB 8161] float64,
                        [RUB 8162] float64,
                        [RUB 8163] float64,
                        [RUB 8164] float64,
                        [RUB 8165] float64,
                        [RUB 8166] float64,
                        [RUB 8169] float64,
                        [RUB 8171] float64,
                        [RUB 8172] float64,
                        [RUB 8173] float64,
                        [RUB 8174] float64,
                        [RUB 8175] float64,
                        [RUB 8176] float64,
                        [RUB 8179] float64,
                        [RUB 8181] float64,
                        [RUB 8182] float64,
                        [RUB 8183] float64,
                        [RUB 8184] float64,
                        [RUB 8185] float64,
                        [RUB 8186] float64,
                        [RUB 8189] float64,
                        [RUB 8191] float64,
                        [RUB 8191P] float64,
                        [RUB 8192] float64,
                        [RUB 8192P] float64,
                        [RUB 8193] float64,
                        [RUB 8193P] float64,
                        [RUB 8194] float64,
                        [RUB 8194P] float64,
                        [RUB 8195] float64,
                        [RUB 8195P] float64,
                        [RUB 8196] float64,
                        [RUB 8196P] float64,
                        [RUB 8199] float64,
                        [RUB 8199P] float64,
                        [RUB 8211] float64,
                        [RUB 8215] float64,
                        [RUB 8219] float64,
                        [RUB 8221] float64,
                        [RUB 8229] float64,
                        [RUB 8232] float64,
                        [RUB 8233] float64,
                        [RUB 8235] float64,
                        [RUB 8239] float64,
                        [RUB 8242] float64,
                        [RUB 8243] float64,
                        [RUB 8249] float64,
                        [RUB 8251] float64,
                        [RUB 8251P] float64,
                        [RUB 8252] float64,
                        [RUB 8252P] float64,
                        [RUB 8253] float64,
                        [RUB 8253P] float64,
                        [RUB 8255] float64,
                        [RUB 8255P] float64,
                        [RUB 8259] float64,
                        [RUB 8259P] float64,
                        [RUB 8271] float64,
                        [RUB 8272] float64,
                        [RUB 8273] float64,
                        [RUB 8274] float64,
                        [RUB 8275] float64,
                        [RUB 8276] float64,
                        [RUB 8279] float64,
                        [RUB 8281] float64,
                        [RUB 8282] float64,
                        [RUB 8283] float64,
                        [RUB 8285] float64,
                        [RUB 8289] float64,
                        [RUB 8291] float64,
                        [RUB 8292] float64,
                        [RUB 8293] float64,
                        [RUB 8294] float64,
                        [RUB 8299] float64,
                        [RUB 8301] float64,
                        [RUB 8302] float64,
                        [RUB 8303] float64,
                        [RUB 8304] float64,
                        [RUB 8305] float64,
                        [RUB 8306] float64,
                        [RUB 8309] float64,
                        [RUB 8311] float64,
                        [RUB 8312] float64,
                        [RUB 8313] float64,
                        [RUB 8314] float64,
                        [RUB 8315] float64,
                        [RUB 8316] float64,
                        [RUB 8319] float64,
                        [RUB 8321] float64,
                        [RUB 8321P] float64,
                        [RUB 8322] float64,
                        [RUB 8322P] float64,
                        [RUB 8323] float64,
                        [RUB 8323P] float64,
                        [RUB 8324] float64,
                        [RUB 8324P] float64,
                        [RUB 8325] float64,
                        [RUB 8325P] float64,
                        [RUB 8326] float64,
                        [RUB 8326P] float64,
                        [RUB 8329] float64,
                        [RUB 8329P] float64,
                        [RUB 8361] float64,
                        [RUB 8362] float64,
                        [RUB 8363] float64,
                        [RUB 8364] float64,
                        [RUB 8365] float64,
                        [RUB 8371] float64,
                        [RUB 8372] float64,
                        [RUB 8373] float64,
                        [RUB 8374] float64,
                        [RUB 8375] float64,
                        [RUB 8381] float64,
                        [RUB 8382] float64,
                        [RUB 8383] float64,
                        [RUB 8384] float64,
                        [RUB 8385] float64,
                        [RUB 8386] float64,
                        [RUB 8391] float64,
                        [RUB 8391P] float64,
                        [RUB 8392] float64,
                        [RUB 8392P] float64,
                        [RUB 8393] float64,
                        [RUB 8393P] float64,
                        [RUB 8394] float64,
                        [RUB 8394P] float64,
                        [RUB 8395] float64,
                        [RUB 8395P] float64,
                        [RUB 8411] float64,
                        [RUB 8412] float64,
                        [RUB 8414] float64,
                        [RUB 8415] float64,
                        [RUB 8425] float64,
                        [RUB 8431] float64,
                        [RUB 8432] float64,
                        [RUB 8434] float64,
                        [RUB 8435] float64,
                        [RUB 8445] float64,
                        [RUB 8451] float64,
                        [RUB 8451P] float64,
                        [RUB 8452] float64,
                        [RUB 8452P] float64,
                        [RUB 8453] float64,
                        [RUB 8453P] float64,
                        [RUB 8454] float64,
                        [RUB 8454P] float64,
                        [RUB 8455] float64,
                        [RUB 8455P] float64,
                        [RUB 8471] float64,
                        [RUB 8472] float64,
                        [RUB 8473] float64,
                        [RUB 8474] float64,
                        [RUB 8475] float64,
                        [RUB 8479] float64,
                        [RUB 8481] float64,
                        [RUB 8482] float64,
                        [RUB 8483] float64,
                        [RUB 8484] float64,
                        [RUB 8485] float64,
                        [RUB 8489] float64,
                        [RUB 8495] float64,
                        [RUB 8501] float64,
                        [RUB 8502] float64,
                        [RUB 8503] float64,
                        [RUB 8504] float64,
                        [RUB 8505] float64,
                        [RUB 8511] float64,
                        [RUB 8512] float64,
                        [RUB 8514] float64,
                        [RUB 8515] float64,
                        [RUB 8521] float64,
                        [RUB 8521P] float64,
                        [RUB 8522] float64,
                        [RUB 8522P] float64,
                        [RUB 8523] float64,
                        [RUB 8523P] float64,
                        [RUB 8524] float64,
                        [RUB 8524P] float64,
                        [RUB 8525] float64,
                        [RUB 8525P] float64,
                        [RUB 8541] float64,
                        [RUB 8542] float64,
                        [RUB 8543] float64,
                        [RUB 8544] float64,
                        [RUB 8545] float64,
                        [RUB 8551] float64,
                        [RUB 8551P] float64,
                        [RUB 8552] float64,
                        [RUB 8552P] float64,
                        [RUB 8553] float64,
                        [RUB 8553P] float64,
                        [RUB 8554] float64,
                        [RUB 8554P] float64,
                        [RUB 8555] float64,
                        [RUB 8555P] float64,
                        [RUB 8564] float64,
                        [RUB 8581] float64,
                        [RUB 8582] float64,
                        [RUB 8583] float64,
                        [RUB 8584] float64,
                        [RUB 8591] float64,
                        [RUB 8592] float64,
                        [RUB 8593] float64,
                        [RUB 8594] float64,
                        [RUB 8601] float64,
                        [RUB 8602] float64,
                        [RUB 8603] float64,
                        [RUB 8604] float64,
                        [RUB 8611] float64,
                        [RUB 8612] float64,
                        [RUB 8613] float64,
                        [RUB 8614] float64,
                        [RUB 8621] float64,
                        [RUB 8623] float64,
                        [RUB 8624] float64,
                        [RUB 8631] float64,
                        [RUB 8632] float64,
                        [RUB 8633] float64,
                        [RUB 8634] float64,
                        [RUB 8644] float64,
                        [RUB 8644P] float64,
                        [RUB 8651] float64,
                        [RUB 8652] float64,
                        [RUB 8653] float64,
                        [RUB 8654] float64,
                        [RUB 8681] float64,
                        [RUB 8682] float64,
                        [RUB 8684] float64,
                        [RUB 8686] float64,
                        [RUB 8687] float64,
                        [RUB 8688] float64,
                        [RUB 8689] float64,
                        [RUB 8702] float64,
                        [RUB 8703] float64,
                        [RUB 8712] float64,
                        [RUB 8721] float64,
                        [RUB 8722] float64,
                        [RUB 8731] float64,
                        [RUB 8732] float64,
                        [RUB 8751] float64,
                        [RUB 8761] float64,
                        [RUB 8762] float64,
                        [RUB 8771] float64,
                        [RUB 8790] float64,
                        [RUB 87901] float64,
                        [RUB 8791] float64,
                        [RUB 8801] float64,
                        [RUB 8802] float64,
                        [RUB 8803] float64,
                        [RUB 8811] float64,
                        [RUB 8812] float64,
                        [RUB 8813] float64,
                        [RUB 8822] float64,
                        [RUB 8823] float64,
                        [RUB 8831] float64,
                        [RUB 8832] float64,
                        [RUB 8833] float64,
                        [RUB 8841] float64,
                        [RUB 8842] float64,
                        [RUB 8843] float64,
                        [RUB 8851] float64,
                        [RUB 8852] float64,
                        [RUB 8853] float64,
                        [RUB 8861] float64,
                        [RUB 8862] float64,
                        [RUB 8863] float64,
                        [RUB 8871] float64,
                        [RUB 8872] float64,
                        [RUB 8873] float64,
                        [RUB 8892] float64,
                        [RUB 8893] float64,
                        [RUB 8901] float64,
                        [RUB 8902] float64,
                        [RUB 8903] float64,
                        [RUB 891] float64,
                        [RUB 8912] float64,
                        [RUB 8913] float64,
                        [RUB 892] float64,
                        [RUB 8921] float64,
                        [RUB 8922] float64,
                        [RUB 8932] float64,
                        [RUB 8951] float64,
                        [RUB 8952] float64,
                        [RUB 8961] float64,
                        [RUB 8962] float64,
                        [RUB 8972] float64,
                        [RUB 8981] float64,
                        [RUB 8982] float64,
                        [RUB 8991] float64,
                        [RUB 8992] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport8;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport8 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric8): %s, args=%s: ", e, e.args)

def limit_rubric8(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 8002",
        "RUB 8003",
        "RUB 8021",
        "RUB 8022",
        "RUB 8023",
        "RUB 8024",
        "RUB 8025",
        "RUB 8029",
        "RUB 8031",
        "RUB 8032",
        "RUB 8033",
        "RUB 8039",
        "RUB 8041",
        "RUB 8042",
        "RUB 8043",
        "RUB 8049",
        "RUB 8051",
        "RUB 8051P",
        "RUB 8052",
        "RUB 8052P",
        "RUB 8053",
        "RUB 8053P",
        "RUB 8054",
        "RUB 8054P",
        "RUB 8055",
        "RUB 8055P",
        "RUB 8056",
        "RUB 8059",
        "RUB 8059P",
        "RUB 8071",
        "RUB 8072",
        "RUB 8073",
        "RUB 8074",
        "RUB 8075",
        "RUB 8079",
        "RUB 8082",
        "RUB 8089",
        "RUB 8092",
        "RUB 8099",
        "RUB 8101",
        "RUB 8102",
        "RUB 8103",
        "RUB 8109",
        "RUB 8111",
        "RUB 8112",
        "RUB 8113",
        "RUB 8119",
        "RUB 8121",
        "RUB 8121P",
        "RUB 8122",
        "RUB 8122P",
        "RUB 8123",
        "RUB 8123P",
        "RUB 8124",
        "RUB 8124P",
        "RUB 8125",
        "RUB 8125P",
        "RUB 8126",
        "RUB 8129",
        "RUB 8129P",
        "RUB 81311",
        "RUB 81312",
        "RUB 81313",
        "RUB 8161",
        "RUB 8162",
        "RUB 8163",
        "RUB 8164",
        "RUB 8165",
        "RUB 8166",
        "RUB 8169",
        "RUB 8171",
        "RUB 8172",
        "RUB 8173",
        "RUB 8174",
        "RUB 8175",
        "RUB 8176",
        "RUB 8179",
        "RUB 8181",
        "RUB 8182",
        "RUB 8183",
        "RUB 8184",
        "RUB 8185",
        "RUB 8186",
        "RUB 8189",
        "RUB 8191",
        "RUB 8191P",
        "RUB 8192",
        "RUB 8192P",
        "RUB 8193",
        "RUB 8193P",
        "RUB 8194",
        "RUB 8194P",
        "RUB 8195",
        "RUB 8195P",
        "RUB 8196",
        "RUB 8196P",
        "RUB 8199",
        "RUB 8199P",
        "RUB 8211",
        "RUB 8215",
        "RUB 8219",
        "RUB 8221",
        "RUB 8229",
        "RUB 8232",
        "RUB 8233",
        "RUB 8235",
        "RUB 8239",
        "RUB 8242",
        "RUB 8243",
        "RUB 8249",
        "RUB 8251",
        "RUB 8251P",
        "RUB 8252",
        "RUB 8252P",
        "RUB 8253",
        "RUB 8253P",
        "RUB 8255",
        "RUB 8255P",
        "RUB 8259",
        "RUB 8259P",
        "RUB 8271",
        "RUB 8272",
        "RUB 8273",
        "RUB 8274",
        "RUB 8275",
        "RUB 8276",
        "RUB 8279",
        "RUB 8281",
        "RUB 8282",
        "RUB 8283",
        "RUB 8285",
        "RUB 8289",
        "RUB 8291",
        "RUB 8292",
        "RUB 8293",
        "RUB 8294",
        "RUB 8299",
        "RUB 8301",
        "RUB 8302",
        "RUB 8303",
        "RUB 8304",
        "RUB 8305",
        "RUB 8306",
        "RUB 8309",
        "RUB 8311",
        "RUB 8312",
        "RUB 8313",
        "RUB 8314",
        "RUB 8315",
        "RUB 8316",
        "RUB 8319",
        "RUB 8321",
        "RUB 8321P",
        "RUB 8322",
        "RUB 8322P",
        "RUB 8323",
        "RUB 8323P",
        "RUB 8324",
        "RUB 8324P",
        "RUB 8325",
        "RUB 8325P",
        "RUB 8326",
        "RUB 8326P",
        "RUB 8329",
        "RUB 8329P",
        "RUB 8361",
        "RUB 8362",
        "RUB 8363",
        "RUB 8364",
        "RUB 8365",
        "RUB 8371",
        "RUB 8372",
        "RUB 8373",
        "RUB 8374",
        "RUB 8375",
        "RUB 8381",
        "RUB 8382",
        "RUB 8383",
        "RUB 8384",
        "RUB 8385",
        "RUB 8386",
        "RUB 8391",
        "RUB 8391P",
        "RUB 8392",
        "RUB 8392P",
        "RUB 8393",
        "RUB 8393P",
        "RUB 8394",
        "RUB 8394P",
        "RUB 8395",
        "RUB 8395P",
        "RUB 8411",
        "RUB 8412",
        "RUB 8414",
        "RUB 8415",
        "RUB 8425",
        "RUB 8431",
        "RUB 8432",
        "RUB 8434",
        "RUB 8435",
        "RUB 8445",
        "RUB 8451",
        "RUB 8451P",
        "RUB 8452",
        "RUB 8452P",
        "RUB 8453",
        "RUB 8453P",
        "RUB 8454",
        "RUB 8454P",
        "RUB 8455",
        "RUB 8455P",
        "RUB 8471",
        "RUB 8472",
        "RUB 8473",
        "RUB 8474",
        "RUB 8475",
        "RUB 8479",
        "RUB 8481",
        "RUB 8482",
        "RUB 8483",
        "RUB 8484",
        "RUB 8485",
        "RUB 8489",
        "RUB 8495",
        "RUB 8501",
        "RUB 8502",
        "RUB 8503",
        "RUB 8504",
        "RUB 8505",
        "RUB 8511",
        "RUB 8512",
        "RUB 8514",
        "RUB 8515",
        "RUB 8521",
        "RUB 8521P",
        "RUB 8522",
        "RUB 8522P",
        "RUB 8523",
        "RUB 8523P",
        "RUB 8524",
        "RUB 8524P",
        "RUB 8525",
        "RUB 8525P",
        "RUB 8541",
        "RUB 8542",
        "RUB 8543",
        "RUB 8544",
        "RUB 8545",
        "RUB 8551",
        "RUB 8551P",
        "RUB 8552",
        "RUB 8552P",
        "RUB 8553",
        "RUB 8553P",
        "RUB 8554",
        "RUB 8554P",
        "RUB 8555",
        "RUB 8555P",
        "RUB 8564",
        "RUB 8581",
        "RUB 8582",
        "RUB 8583",
        "RUB 8584",
        "RUB 8591",
        "RUB 8592",
        "RUB 8593",
        "RUB 8594",
        "RUB 8601",
        "RUB 8602",
        "RUB 8603",
        "RUB 8604",
        "RUB 8611",
        "RUB 8612",
        "RUB 8613",
        "RUB 8614",
        "RUB 8621",
        "RUB 8623",
        "RUB 8624",
        "RUB 8631",
        "RUB 8632",
        "RUB 8633",
        "RUB 8634",
        "RUB 8644",
        "RUB 8644P",
        "RUB 8651",
        "RUB 8652",
        "RUB 8653",
        "RUB 8654",
        "RUB 8681",
        "RUB 8682",
        "RUB 8684",
        "RUB 8686",
        "RUB 8687",
        "RUB 8688",
        "RUB 8689",
        "RUB 8702",
        "RUB 8703",
        "RUB 8712",
        "RUB 8721",
        "RUB 8722",
        "RUB 8731",
        "RUB 8732",
        "RUB 8751",
        "RUB 8761",
        "RUB 8762",
        "RUB 8771",
        "RUB 8790",
        "RUB 87901",
        "RUB 8791",
        "RUB 8801",
        "RUB 8802",
        "RUB 8803",
        "RUB 8811",
        "RUB 8812",
        "RUB 8813",
        "RUB 8822",
        "RUB 8823",
        "RUB 8831",
        "RUB 8832",
        "RUB 8833",
        "RUB 8841",
        "RUB 8842",
        "RUB 8843",
        "RUB 8851",
        "RUB 8852",
        "RUB 8853",
        "RUB 8861",
        "RUB 8862",
        "RUB 8863",
        "RUB 8871",
        "RUB 8872",
        "RUB 8873",
        "RUB 8892",
        "RUB 8893",
        "RUB 8901",
        "RUB 8902",
        "RUB 8903",
        "RUB 891",
        "RUB 8912",
        "RUB 8913",
        "RUB 892",
        "RUB 8921",
        "RUB 8922",
        "RUB 8932",
        "RUB 8951",
        "RUB 8952",
        "RUB 8961",
        "RUB 8962",
        "RUB 8972",
        "RUB 8981",
        "RUB 8982",
        "RUB 8991",
        "RUB 8992",
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db8(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport8', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport8")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport8 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric8): %s, args=%s: ", e, e.args)

#ARS9
def create_table_nbb_rubric9(db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        cur.execute("""CREATE TABLE if not exists Tbl_RawData_NBB_rubricReport9 (
                        CompanyNumber text,
                        AccountingYear int94,
                        Schema object,
                        [RUB 901] float64,
                        [RUB 9012] float64,
                        [RUB 902] float64,
                        [RUB 9021] float64,
                        [RUB 9022] float64,
                        [RUB 9032] float64,
                        [RUB 9042] float64,
                        [RUB 9051] float64,
                        [RUB 9052] float64,
                        [RUB 9061] float64,
                        [RUB 9062] float64,
                        [RUB 9072] float64,
                        [RUB 9073] float64,
                        [RUB 9076] float64,
                        [RUB 9077] float64,
                        [RUB 9078] float64,
                        [RUB 9086] float64,
                        [RUB 9087] float64,
                        [RUB 9088] float64,
                        [RUB 9096] float64,
                        [RUB 9097] float64,
                        [RUB 9098] float64,
                        [RUB 9110] float64,
                        [RUB 9111] float64,
                        [RUB 9112] float64,
                        [RUB 9113] float64,
                        [RUB 9115] float64,
                        [RUB 9116] float64,
                        [RUB 9125] float64,
                        [RUB 9126] float64,
                        [RUB 9130] float64,
                        [RUB 9131] float64,
                        [RUB 9134] float64,
                        [RUB 9135] float64,
                        [RUB 9136] float64,
                        [RUB 9137] float64,
                        [RUB 9138] float64,
                        [RUB 9139] float64,
                        [RUB 9140] float64,
                        [RUB 9141] float64,
                        [RUB 9142] float64,
                        [RUB 9144] float64,
                        [RUB 9145] float64,
                        [RUB 9146] float64,
                        [RUB 9147] float64,
                        [RUB 9148] float64,
                        [RUB 9149] float64,
                        [RUB 9153] float64,
                        [RUB 9161] float64,
                        [RUB 91611] float64,
                        [RUB 91612] float64,
                        [RUB 9162] float64,
                        [RUB 91621] float64,
                        [RUB 91622] float64,
                        [RUB 91631] float64,
                        [RUB 91632] float64,
                        [RUB 9171] float64,
                        [RUB 91711] float64,
                        [RUB 91712] float64,
                        [RUB 9172] float64,
                        [RUB 91721] float64,
                        [RUB 91722] float64,
                        [RUB 9181] float64,
                        [RUB 91811] float64,
                        [RUB 91812] float64,
                        [RUB 9182] float64,
                        [RUB 91821] float64,
                        [RUB 91822] float64,
                        [RUB 9191] float64,
                        [RUB 91911] float64,
                        [RUB 91912] float64,
                        [RUB 9192] float64,
                        [RUB 91921] float64,
                        [RUB 91922] float64,
                        [RUB 9201] float64,
                        [RUB 92011] float64,
                        [RUB 92021] float64,
                        [RUB 9213] float64,
                        [RUB 9214] float64,
                        [RUB 9215] float64,
                        [RUB 9216] float64,
                        [RUB 9220] float64,
                        [RUB 9252] float64,
                        [RUB 9253] float64,
                        [RUB 9262] float64,
                        [RUB 9263] float64,
                        [RUB 9271] float64,
                        [RUB 9272] float64,
                        [RUB 9281] float64,
                        [RUB 9282] float64,
                        [RUB 9283] float64,
                        [RUB 9291] float64,
                        [RUB 9292] float64,
                        [RUB 9293] float64,
                        [RUB 9294] float64,
                        [RUB 9295] float64,
                        [RUB 9301] float64,
                        [RUB 9302] float64,
                        [RUB 9303] float64,
                        [RUB 9311] float64,
                        [RUB 9312] float64,
                        [RUB 9313] float64,
                        [RUB 9321] float64,
                        [RUB 9331] float64,
                        [RUB 9341] float64,
                        [RUB 9351] float64,
                        [RUB 9352] float64,
                        [RUB 9353] float64,
                        [RUB 9361] float64,
                        [RUB 9362] float64,
                        [RUB 9363] float64,
                        [RUB 9371] float64,
                        [RUB 9372] float64,
                        [RUB 9373] float64,
                        [RUB 9381] float64,
                        [RUB 9383] float64,
                        [RUB 9391] float64,
                        [RUB 9393] float64,
                        [RUB 9401] float64,
                        [RUB 9421] float64,
                        [RUB 9431] float64,
                        [RUB 9441] float64,
                        [RUB 9461] float64,
                        [RUB 9471] float64,
                        [RUB 9481] float64,
                        [RUB 9491] float64,
                        [RUB 9500] float64,
                        [RUB 9501] float64,
                        [RUB 9502] float64,
                        [RUB 9503] float64,
                        [RUB 9504] float64,
                        [RUB 9505] float64,
                        [RUB 95061] float64,
                        [RUB 95062] float64,
                        [RUB 95063] float64,
                        [RUB 9507] float64,
                        [RUB 95071] float64,
                        [RUB 95072] float64,
                        [RUB 95073] float64,
                        [RUB 95081] float64,
                        [RUB 95082] float64,
                        [RUB 95083] float64,
                        [RUB 9509] float64,
                        [RUB 95091] float64,
                        [RUB 95092] float64,
                        [RUB 95093] float64,
                        [RUB 9800] float64,
                        [RUB 9900] float64,
                        [RUB 9901] float64,
                        [RUB 9903] float64,
                        [RUB 9904] float64,
                        [RUB 9905] float64,
                        [RUB 9906] float64,
                        FileBase object);""")
        cur.execute("""DELETE FROM Tbl_RawData_NBB_rubricReport9;""")  # truncate
        helper.logger.info("Table Tbl_RawData_NBB_rubricReport9 has been created")
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb_rubric9): %s, args=%s: ", e, e.args)

def limit_rubric9(df):
    return df.reindex(columns=[
        "CompanyNumber",
        "AccountingYear",
        "Schema",
        "RUB 901",
        "RUB 9012",
        "RUB 902",
        "RUB 9021",
        "RUB 9022",
        "RUB 9032",
        "RUB 9042",
        "RUB 9051",
        "RUB 9052",
        "RUB 9061",
        "RUB 9062",
        "RUB 9072",
        "RUB 9073",
        "RUB 9076",
        "RUB 9077",
        "RUB 9078",
        "RUB 9086",
        "RUB 9087",
        "RUB 9088",
        "RUB 9096",
        "RUB 9097",
        "RUB 9098",
        "RUB 9110",
        "RUB 9111",
        "RUB 9112",
        "RUB 9113",
        "RUB 9115",
        "RUB 9116",
        "RUB 9125",
        "RUB 9126",
        "RUB 9130",
        "RUB 9131",
        "RUB 9134",
        "RUB 9135",
        "RUB 9136",
        "RUB 9137",
        "RUB 9138",
        "RUB 9139",
        "RUB 9140",
        "RUB 9141",
        "RUB 9142",
        "RUB 9144",
        "RUB 9145",
        "RUB 9146",
        "RUB 9147",
        "RUB 9148",
        "RUB 9149",
        "RUB 9153",
        "RUB 9161",
        "RUB 91611",
        "RUB 91612",
        "RUB 9162",
        "RUB 91621",
        "RUB 91622",
        "RUB 91631",
        "RUB 91632",
        "RUB 9171",
        "RUB 91711",
        "RUB 91712",
        "RUB 9172",
        "RUB 91721",
        "RUB 91722",
        "RUB 9181",
        "RUB 91811",
        "RUB 91812",
        "RUB 9182",
        "RUB 91821",
        "RUB 91822",
        "RUB 9191",
        "RUB 91911",
        "RUB 91912",
        "RUB 9192",
        "RUB 91921",
        "RUB 91922",
        "RUB 9201",
        "RUB 92011",
        "RUB 92021",
        "RUB 9213",
        "RUB 9214",
        "RUB 9215",
        "RUB 9216",
        "RUB 9220",
        "RUB 9252",
        "RUB 9253",
        "RUB 9262",
        "RUB 9263",
        "RUB 9271",
        "RUB 9272",
        "RUB 9281",
        "RUB 9282",
        "RUB 9283",
        "RUB 9291",
        "RUB 9292",
        "RUB 9293",
        "RUB 9294",
        "RUB 9295",
        "RUB 9301",
        "RUB 9302",
        "RUB 9303",
        "RUB 9311",
        "RUB 9312",
        "RUB 9313",
        "RUB 9321",
        "RUB 9331",
        "RUB 9341",
        "RUB 9351",
        "RUB 9352",
        "RUB 9353",
        "RUB 9361",
        "RUB 9362",
        "RUB 9363",
        "RUB 9371",
        "RUB 9372",
        "RUB 9373",
        "RUB 9381",
        "RUB 9383",
        "RUB 9391",
        "RUB 9393",
        "RUB 9401",
        "RUB 9421",
        "RUB 9431",
        "RUB 9441",
        "RUB 9461",
        "RUB 9471",
        "RUB 9481",
        "RUB 9491",
        "RUB 9500",
        "RUB 9501",
        "RUB 9502",
        "RUB 9503",
        "RUB 9504",
        "RUB 9505",
        "RUB 95061",
        "RUB 95062",
        "RUB 95063",
        "RUB 9507",
        "RUB 95071",
        "RUB 95072",
        "RUB 95073",
        "RUB 95081",
        "RUB 95082",
        "RUB 95083",
        "RUB 9509",
        "RUB 95091",
        "RUB 95092",
        "RUB 95093",
        "RUB 9800",
        "RUB 9900",
        "RUB 9901",
        "RUB 9903",
        "RUB 9904",
        "RUB 9905",
        "RUB 9906",
        "FileBase"], fill_value=0)

def df_nbb_rubric_to_db9(df, db_path):
    try:
        conn, cur = tb.create_connection(db_path)
        df.to_sql(name='Tbl_RawData_NBB_rubricReport9', con=conn, if_exists='append', index=False)
        cur.execute("SELECT count(*) as records FROM Tbl_RawData_NBB_rubricReport9")
        result = cur.fetchall()
        helper.logger.info("Tbl_RawData_NBB_rubricReport9 has %s records", result[0][0])
        conn.commit()
        conn.close()
    except Exception as e:
        helper.logger.info("Error: Oeps, something went wrong (nbb rubric9): %s, args=%s: ", e, e.args)

#endregion Rubric


# todo: check eerste lijn op old_text en dan pas vervangen
def import_nbb(db_path, nbbpath, searchstringannual, searchstringratio, searchstringrubric):
    helper.logger.info("Started NBB ANNUAL")
    helper.logger.info("-------------------------")
    # db_path = os.path.join(path, database)
    # list_files = fm.walk(os.path.join(path, dir_in), '.csv')
    list_files = fm.walk(nbbpath, '.csv')
    helper.logger.info(list_files)
    conn = tb.create_connection(db_path)
    create_table_nbb_annual(db_path)
    create_table_nbb_ratio(db_path)
    create_table_nbb_rubric1(db_path)
    create_table_nbb_rubric2(db_path)
    create_table_nbb_rubric3(db_path)
    create_table_nbb_rubric4(db_path)
    create_table_nbb_rubric5(db_path)
    create_table_nbb_rubric6(db_path)
    create_table_nbb_rubric7(db_path)
    create_table_nbb_rubric8(db_path)
    create_table_nbb_rubric9(db_path)

    count = 0
    for full_path in list_files:
        count += 1
        helper.logger.info("Behandel file: %s", full_path)
        file_without_ext = fm.get_filename_without_extension(full_path)
        table = determine_import_table(file_without_ext, searchstringannual, searchstringratio, searchstringrubric)
        if table == "Tbl_RawData_NBB_AnnualAccountReport":
            df = pd.read_csv(full_path, sep=";", encoding="utf-8")  # checked with chardet
            df['FileBase'] = full_path
            df['CompanyNumber'] = '0' + df['CompanyNumber'].astype(str)
            df.rename(columns={
                df.columns[12]: "PostalCodeDE1",}
                , inplace=True)
            # print("Df", count, len(df), full_path)
            frames = [df]
            df = pd.concat(frames)
            helper.logger.info("Import %s records in df from file %s", len(df), full_path)
            df_nbb_annual_to_db(df, db_path)
            helper.logger.info("==============================================================================================")
        elif table == "Tbl_RawData_NBB_ratioReport":
            fm.convert_csv_to_excel(full_path)
            path = fm.get_path(full_path)
            old_file = fm.get_filename(full_path)
            new_file = fm.get_filename_without_extension(old_file) + ".xlsx"
            full_path = os.path.join(path, new_file)
            df = pd.read_excel(full_path)
            df['FileBase'] = full_path
            df['CompanyNumber'] = '0' + df['CompanyNumber'].astype(str)
            frames = [df]
            df = pd.concat(frames)
            helper.logger.info("Import %s records in df from file %s", len(df), full_path)
            df_nbb_ratio_to_db(df, db_path)
            os.remove(full_path)
        elif table == "Tbl_RawData_NBB_rubricReport":
            #importeer file(s) in df
            df = pd.read_csv(full_path, sep=";", encoding="ascii")  # checked with chardet
            df['FileBase'] = full_path
            df['CompanyNumber'] = '0' + df['CompanyNumber'].astype(str)
            # print("Df", count, len(df), full_path)
            frames = [df]
            df = pd.concat(frames)
            helper.logger.info("Import %s records in df from file %s", len(df), full_path)
            # Enkel ARS1
            df1 = limit_rubric1(df)
            df_nbb_rubric_to_db1(df1, db_path)
            helper.logger.info("==============================================================================================")
            # Enkel ARS2
            df2 = limit_rubric2(df)
            df_nbb_rubric_to_db2(df2, db_path)
            helper.logger.info("==============================================================================================")
            # Enkel ARS3
            df3 = limit_rubric3(df)
            df_nbb_rubric_to_db3(df3, db_path)
            helper.logger.info("==============================================================================================")
            # Enkel ARS4
            df4 = limit_rubric4(df)
            df_nbb_rubric_to_db4(df4, db_path)
            helper.logger.info("==============================================================================================")
            # Enkel ARS5
            df5 = limit_rubric5(df)
            df_nbb_rubric_to_db5(df5, db_path)
            helper.logger.info("==============================================================================================")
            # Enkel ARS6
            df6 = limit_rubric6(df)
            df_nbb_rubric_to_db6(df6, db_path)
            helper.logger.info("==============================================================================================")
            # # Enkel ARS7
            df7 = limit_rubric7(df)
            df_nbb_rubric_to_db7(df7, db_path)
            helper.logger.info("==============================================================================================")
            # # Enkel ARS8
            df8 = limit_rubric8(df)
            df_nbb_rubric_to_db8(df8, db_path)
            helper.logger.info("==============================================================================================")
            # Enkel ARS9
            df9 = limit_rubric9(df)
            df_nbb_rubric_to_db9(df9, db_path)
            helper.logger.info("==============================================================================================")
